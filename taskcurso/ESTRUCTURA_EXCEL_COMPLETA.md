# üìä Ejemplos de Excel para Base de Datos Sol Store

Este documento explica la estructura exacta de cada tabla y c√≥mo preparar los archivos Excel/CSV para importarlos.

---

## üéØ Orden de Importaci√≥n (IMPORTANTE)

**DEBES importar en este orden debido a las dependencias entre tablas:**

```
1. Categories (categor√≠as)        ‚Üê Primero
2. Themes (tem√°ticas)            ‚Üê Segundo
3. Materiales                     ‚Üê Tercero
4. Usuarios (opcional)            ‚Üê Cuarto
5. Productos                      ‚Üê Quinto (depende de categories y themes)
```

---

## üìã Estructura de Tablas y Ejemplos

### 1Ô∏è‚É£ Categories (Categor√≠as)

**Tabla:** `categories`  
**Archivo:** `1_categories.csv`

#### Campos:
| Campo | Tipo | Obligatorio | Descripci√≥n | Ejemplo |
|-------|------|-------------|-------------|---------|
| name | string | ‚úÖ S√≠ | Nombre √∫nico de la categor√≠a | `Ropa` |
| imagen | string | ‚ùå No | URL de la imagen | `https://example.com/ropa.jpg` |

#### Excel/CSV de ejemplo:
```csv
name,imagen
Ropa,https://example.com/images/ropa.jpg
Accesorios,https://example.com/images/accesorios.jpg
Juguetes,https://example.com/images/juguetes.jpg
Hogar y Decoraci√≥n,https://example.com/images/hogar.jpg
Tecnolog√≠a,https://example.com/images/tecnologia.jpg
Papeler√≠a,https://example.com/images/papeleria.jpg
Coleccionables,https://example.com/images/coleccionables.jpg
```

#### ‚ö†Ô∏è Validaciones:
- `name` debe ser √∫nico (no puede repetirse)
- Si no tienes imagen, deja la columna vac√≠a pero mant√©n la coma: `Ropa,`

---

### 2Ô∏è‚É£ Themes (Tem√°ticas)

**Tabla:** `themes`  
**Archivo:** `2_themes.csv`

#### Campos:
| Campo | Tipo | Obligatorio | Descripci√≥n | Ejemplo |
|-------|------|-------------|-------------|---------|
| name | string | ‚úÖ S√≠ | Nombre √∫nico de la tem√°tica | `Videojuegos` |
| imagen | string | ‚ùå No | URL de la imagen | `https://example.com/videojuegos.jpg` |

#### Excel/CSV de ejemplo:
```csv
name,imagen
Videojuegos,https://example.com/images/videojuegos.jpg
Anime,https://example.com/images/anime.jpg
Pel√≠culas,https://example.com/images/peliculas.jpg
Series de TV,https://example.com/images/series.jpg
C√≥mics,https://example.com/images/comics.jpg
M√∫sica,https://example.com/images/musica.jpg
Deportes,https://example.com/images/deportes.jpg
Fantas√≠a,https://example.com/images/fantasia.jpg
```

#### ‚ö†Ô∏è Validaciones:
- `name` debe ser √∫nico
- Similar a categories

---

### 3Ô∏è‚É£ Materiales

**Tabla:** `materiales`  
**Archivo:** `3_materiales.csv`

#### Campos:
| Campo | Tipo | Obligatorio | Descripci√≥n | Ejemplo |
|-------|------|-------------|-------------|---------|
| nombre | string | ‚úÖ S√≠ | Nombre √∫nico del material | `Algod√≥n` |

#### Excel/CSV de ejemplo:
```csv
nombre
Algod√≥n
Poli√©ster
Cer√°mica
Pl√°stico
Metal
Vinilo
Tela
Acr√≠lico
Madera
Silicona
```

#### ‚ö†Ô∏è Validaciones:
- `nombre` debe ser √∫nico
- Tabla muy simple, solo un campo

---

### 4Ô∏è‚É£ Usuarios

**Tabla:** `usuarios`  
**Archivo:** `4_usuarios.csv`

#### Campos:
| Campo | Tipo | Obligatorio | Descripci√≥n | Ejemplo |
|-------|------|-------------|-------------|---------|
| first_name | string(100) | ‚úÖ S√≠ | Nombre | `Juan` |
| last_name | string(100) | ‚úÖ S√≠ | Apellido | `P√©rez` |
| email | string(255) | ‚úÖ S√≠ | Email √∫nico | `juan@example.com` |
| password | string(255) | ‚úÖ S√≠ | Contrase√±a hasheada | `$2y$12$...` |

#### Excel/CSV de ejemplo:
```csv
first_name,last_name,email,password
Juan,P√©rez,juan.perez@example.com,$2y$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5HS9h.tZx.Gla
Mar√≠a,Garc√≠a,maria.garcia@example.com,$2y$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5HS9h.tZx.Gla
Carlos,L√≥pez,carlos.lopez@example.com,$2y$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5HS9h.tZx.Gla
```

#### ‚ö†Ô∏è Validaciones y Notas:
- `email` debe ser √∫nico y v√°lido
- El password mostrado es el hash de `password123`
- **Para generar el hash de una contrase√±a:**
  ```bash
  php artisan tinker
  >>> bcrypt('tuContrase√±a')
  ```
- O puedes usar este hash que equivale a `password123`:
  ```
  $2y$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5HS9h.tZx.Gla
  ```

---

### 5Ô∏è‚É£ Productos ‚≠ê (Tabla Principal)

**Tabla:** `productos`  
**Archivo:** `5_productos.csv`

#### Campos:
| Campo | Tipo | Obligatorio | Descripci√≥n | Ejemplo | Notas |
|-------|------|-------------|-------------|---------|-------|
| nombre | string(2000) | ‚úÖ S√≠ | Nombre del producto | `Camiseta Gamer` | |
| categoria | string | ‚úÖ S√≠ | Nombre de la categor√≠a | `Ropa` | Busca en tabla `categories` |
| tematica | string | ‚úÖ S√≠ | Nombre de la tem√°tica | `Videojuegos` | Busca en tabla `themes` |
| descripcion | text | ‚ùå No | Descripci√≥n detallada | `Camiseta 100% algod√≥n...` | |
| precio_base | decimal(10,2) | ‚úÖ S√≠ | Precio en pesos | `29990` o `29990.00` | Sin s√≠mbolos |
| stock | integer | ‚úÖ S√≠ | Cantidad disponible | `50` | N√∫mero entero |
| imagen | string(2000) | ‚ùå No | URL de la imagen | `https://...jpg` | |
| status | enum | ‚úÖ S√≠ | Estado del producto | `activo` o `inactivo` | Solo estos valores |

#### Excel/CSV de ejemplo (completo):
```csv
nombre,categoria,tematica,descripcion,precio_base,stock,imagen,status
Camiseta Gamer Level Up,Ropa,Videojuegos,"Camiseta de algod√≥n 100% con dise√±o de control de videojuegos y texto 'Level Up'. Disponible en color negro con estampado blanco. Corte unisex, ideal para gamers.",29990,50,https://example.com/images/camiseta-gamer.jpg,activo
Taza Star Wars Darth Vader,Hogar y Decoraci√≥n,Pel√≠culas,"Taza de cer√°mica de 350ml con dise√±o de Darth Vader. Apta para microondas y lavavajillas. Acabado mate en color negro con detalles en rojo.",15990,100,https://example.com/images/taza-darth-vader.jpg,activo
Figura Naruto Uzumaki,Juguetes,Anime,"Figura coleccionable de Naruto Uzumaki de 15cm de altura. Material PVC de alta calidad con detalles pintados a mano. Incluye base de soporte y viene en caja decorativa.",39990,30,https://example.com/images/figura-naruto.jpg,activo
Poster Marvel Avengers,Hogar y Decoraci√≥n,Pel√≠culas,"Poster de alta calidad 50x70cm con dise√±o de los Avengers. Impresi√≥n en papel couch√© de 300gr. Colores vibrantes y resistentes a la luz.",9990,75,https://example.com/images/poster-avengers.jpg,activo
Gorra Pok√©mon Pikachu,Accesorios,Videojuegos,"Gorra ajustable de algod√≥n con bordado de Pikachu en la parte frontal. Cierre regulable en la parte trasera. Color amarillo y negro.",19990,40,https://example.com/images/gorra-pokemon.jpg,activo
```

#### ‚ö†Ô∏è Validaciones Importantes:
- **categoria**: Debe existir EXACTAMENTE en la tabla `categories` (campo `name`)
- **tematica**: Debe existir EXACTAMENTE en la tabla `themes` (campo `name`)
- **precio_base**: Solo n√∫meros, puede tener decimales (29990 o 29990.50)
- **stock**: Solo n√∫meros enteros positivos
- **status**: Solo puede ser `activo` o `inactivo`

#### üí° Consejos para Productos:
1. **Categor√≠as y Tem√°ticas**: Deben coincidir EXACTAMENTE con los nombres que usaste al importar esas tablas
   - ‚úÖ Correcto: `Ropa` (si as√≠ lo creaste en categories)
   - ‚ùå Incorrecto: `ropa`, `ROPA`, `Ropa ` (con espacio)

2. **Precios**: Usa el formato chileno sin puntos ni s√≠mbolos
   - ‚úÖ Correcto: `29990`, `29990.50`
   - ‚ùå Incorrecto: `$29.990`, `29,990`

3. **Descripciones**: Si tienen comas, encierra todo entre comillas dobles
   ```csv
   nombre,descripcion
   Producto,"Esta es una descripci√≥n con comas, puntos, y m√°s."
   ```

---

## üöÄ Proceso Completo de Importaci√≥n

### Paso 1: Preparar los archivos

1. Crea los 5 archivos CSV en Excel:
   - `1_categories.csv`
   - `2_themes.csv`
   - `3_materiales.csv`
   - `4_usuarios.csv` (opcional)
   - `5_productos.csv`

2. Al guardar desde Excel:
   - **Archivo ‚Üí Guardar como**
   - Formato: **CSV (delimitado por comas) (*.csv)**
   - Encoding: **UTF-8** (importante)

### Paso 2: Colocar archivos

```bash
# Crear carpeta si no existe
mkdir -p taskcurso/storage/app/imports

# Copiar todos los archivos
cp 1_categories.csv taskcurso/storage/app/imports/
cp 2_themes.csv taskcurso/storage/app/imports/
cp 3_materiales.csv taskcurso/storage/app/imports/
cp 4_usuarios.csv taskcurso/storage/app/imports/
cp 5_productos.csv taskcurso/storage/app/imports/
```

### Paso 3: Ejecutar importaci√≥n

```bash
cd taskcurso

# Importar todo de una vez
php artisan db:seed --class=ExcelImportSeeder
```

### Paso 4: Verificar

```bash
php artisan tinker

# Verificar categor√≠as
>>> DB::table('categories')->count()
=> 7

# Verificar themes
>>> DB::table('themes')->count()
=> 8

# Verificar productos
>>> DB::table('productos')->count()
=> 20

# Ver primeros productos
>>> DB::table('productos')->limit(3)->get()
```

---

## üìù Plantillas en Blanco para Excel

### Categor√≠as:
```csv
name,imagen
,
,
,
```

### Tem√°ticas:
```csv
name,imagen
,
,
,
```

### Materiales:
```csv
nombre
,
,
,
```

### Usuarios:
```csv
first_name,last_name,email,password
,,,
,,,
,,,
```

### Productos:
```csv
nombre,categoria,tematica,descripcion,precio_base,stock,imagen,status
,,,,,,,
,,,,,,,
,,,,,,,
```

---

## üî• Tips Pro

### 1. Validar antes de importar
```bash
# Ver preview sin importar
php artisan import:csv storage/app/imports/5_productos.csv productos --dry-run
```

### 2. Importar solo una tabla
```bash
# Modificar ExcelImportSeeder.php:
$toImport = [
    // 'categories',
    // 'themes',
    // 'materiales',
    // 'usuarios',
    'productos',  // Solo esta
];
```

### 3. Limpiar y volver a importar
```bash
php artisan tinker

# Limpiar todas las tablas (CUIDADO: borra todo)
>>> DB::table('productos')->truncate();
>>> DB::table('categories')->truncate();
>>> DB::table('themes')->truncate();
>>> DB::table('materiales')->truncate();

# Volver a importar
>>> exit
php artisan db:seed --class=ExcelImportSeeder
```

### 4. Usar valores por defecto
Si no quieres llenar algunos campos opcionales, el sistema usar√°:
- `created_at` y `updated_at`: Se llenan autom√°ticamente con la fecha actual
- `imagen`: Si no la tienes, d√©jala vac√≠a o pon una URL gen√©rica
- `descripcion`: Puede estar vac√≠a

---

## ‚ö†Ô∏è Errores Comunes

### Error: "Foreign key constraint fails"
**Causa:** Intentas crear un producto con una categor√≠a o tem√°tica que no existe.

**Soluci√≥n:**
1. Verifica que las categor√≠as y tem√°ticas est√©n importadas primero
2. Verifica que los nombres coincidan EXACTAMENTE (may√∫sculas, espacios, etc.)

```bash
# Ver categor√≠as disponibles
php artisan tinker
>>> DB::table('categories')->pluck('name')
=> ["Ropa", "Accesorios", "Juguetes", ...]

# Ver tem√°ticas disponibles
>>> DB::table('themes')->pluck('name')
=> ["Videojuegos", "Anime", "Pel√≠culas", ...]
```

### Error: "Duplicate entry"
**Causa:** Intentas insertar un valor que debe ser √∫nico (email, name de category, etc.)

**Soluci√≥n:**
- Revisa tu CSV y elimina duplicados
- Si ya existe en la BD, elim√≠nalo primero:
```bash
php artisan tinker
>>> DB::table('categories')->where('name', 'Ropa')->delete();
```

### Error: Caracteres raros (√±, tildes)
**Causa:** Encoding incorrecto del CSV.

**Soluci√≥n:**
- Guarda el CSV con encoding UTF-8
- En Excel: Guardar como ‚Üí CSV UTF-8

---

## üìû Checklist Pre-Importaci√≥n

Antes de importar, verifica:

- [ ] Los archivos CSV tienen la extensi√≥n `.csv`
- [ ] Los encabezados coinciden EXACTAMENTE con los ejemplos
- [ ] No hay espacios extra en los nombres de columnas
- [ ] Las categor√≠as y tem√°ticas existen antes de importar productos
- [ ] Los precios son n√∫meros sin s√≠mbolos ($, puntos, comas)
- [ ] El status es `activo` o `inactivo` (min√∫sculas)
- [ ] Los emails de usuarios son √∫nicos
- [ ] El encoding es UTF-8

---

## üéÅ Archivos de Ejemplo Incluidos

En `storage/app/imports/` encontrar√°s:
- ‚úÖ `1_categories.csv` - 7 categor√≠as de ejemplo
- ‚úÖ `2_themes.csv` - 8 tem√°ticas de ejemplo
- ‚úÖ `3_materiales.csv` - 10 materiales de ejemplo
- ‚úÖ `4_usuarios.csv` - 5 usuarios de ejemplo (password: `password123`)
- ‚úÖ `5_productos.csv` - 20 productos completos de ejemplo

**Puedes usarlos directamente:**
```bash
cd taskcurso
php artisan db:seed --class=ExcelImportSeeder
```

¬°Listo para poblar tu base de datos! üéâ
